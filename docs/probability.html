<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>4 Probability | (Re)Doing Bayesain Data Analysis</title>
  <meta name="description" content="4 Probability | (Re)Doing Bayesain Data Analysis">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="4 Probability | (Re)Doing Bayesain Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Probability | (Re)Doing Bayesain Data Analysis" />
  
  
  

<meta name="author" content="R Pruim">


<meta name="date" content="2019-01-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="some-useful-bits-of-r.html">
<link rel="next" href="bayes-rule-and-the-grid-method.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="whats-in-these-notes.html"><a href="whats-in-these-notes.html"><i class="fa fa-check"></i><b>1</b> What’s in These Notes</a></li>
<li class="part"><span><b>I The Basics: Models, Probability, Bayes, and R</b></span></li>
<li class="chapter" data-level="2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.1</b> The Steps of Bayesian Data Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R code</a></li>
<li class="chapter" data-level="2.1.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-packages"><i class="fa fa-check"></i><b>2.1.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-1-which-coin-is-it"><i class="fa fa-check"></i><b>2.2</b> Example 1: Which coin is it?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#freedom-of-choice"><i class="fa fa-check"></i><b>2.2.1</b> Freedom of choice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#distribtions"><i class="fa fa-check"></i><b>2.3</b> Distribtions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#beta-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Beta distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#normal-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-2-height-vs-weight"><i class="fa fa-check"></i><b>2.4</b> Example 2: Height vs Weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#data"><i class="fa fa-check"></i><b>2.4.1</b> Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#describing-a-model-for-the-relationship-between-height-and-weight"><i class="fa fa-check"></i><b>2.4.2</b> Describing a model for the relationship between height and weight</a></li>
<li class="chapter" data-level="2.4.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#prior"><i class="fa fa-check"></i><b>2.4.3</b> Prior</a></li>
<li class="chapter" data-level="2.4.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior"><i class="fa fa-check"></i><b>2.4.4</b> Posterior</a></li>
<li class="chapter" data-level="2.4.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior-predictive-check"><i class="fa fa-check"></i><b>2.4.5</b> Posterior Predictive Check</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#where-to-we-go-from-here"><i class="fa fa-check"></i><b>2.5</b> Where to we go from here?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html"><i class="fa fa-check"></i><b>3</b> Some Useful Bits of R</a><ul>
<li class="chapter" data-level="3.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors-lists-and-data-frames"><i class="fa fa-check"></i><b>3.1</b> Vectors, Lists, and Data Frames</a><ul>
<li class="chapter" data-level="3.1.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors"><i class="fa fa-check"></i><b>3.1.1</b> Vectors</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#lists"><i class="fa fa-check"></i><b>3.1.2</b> Lists</a></li>
<li class="chapter" data-level="3.1.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#data-frames-for-rectangular-data"><i class="fa fa-check"></i><b>3.1.3</b> Data frames for rectangular data</a></li>
<li class="chapter" data-level="3.1.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#other-types-of-data"><i class="fa fa-check"></i><b>3.1.4</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#plotting-with-ggformula"><i class="fa fa-check"></i><b>3.2</b> Plotting with ggformula</a></li>
<li class="chapter" data-level="3.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#creating-data-with-expand.grid"><i class="fa fa-check"></i><b>3.3</b> Creating data with expand.grid()</a></li>
<li class="chapter" data-level="3.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#transforming-and-summarizing-data-dplyr"><i class="fa fa-check"></i><b>3.4</b> Transforming and summarizing data dplyr</a></li>
<li class="chapter" data-level="3.5" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#wide-data-vs-long-data-and-other-uses-of-tidyr"><i class="fa fa-check"></i><b>3.5</b> Wide Data vs Long Data and other uses of tidyr</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#some-terminology"><i class="fa fa-check"></i><b>4.1</b> Some Terminology</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#distributions-in-r"><i class="fa fa-check"></i><b>4.2</b> Distributions in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#example-normal-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Example: Normal distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability.html"><a href="probability.html#simulating"><i class="fa fa-check"></i><b>4.2.2</b> Simulating</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#joint-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint Distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability.html"><a href="probability.html#example-hair-and-eye-color"><i class="fa fa-check"></i><b>4.3.1</b> Example: Hair and Eye Color</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>4.3.2</b> Conditional probability</a></li>
<li class="chapter" data-level="4.3.3" data-path="probability.html"><a href="probability.html#independence-of-attributes"><i class="fa fa-check"></i><b>4.3.3</b> Independence of attributes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule and the Grid Method</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#estimating-the-bias-in-a-coin-using-the-grid-method"><i class="fa fa-check"></i><b>5.1</b> Estimating the bias in a coin using the Grid Method</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#creating-a-grid"><i class="fa fa-check"></i><b>5.1.1</b> Creating a Grid</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#plots-from-the-grid"><i class="fa fa-check"></i><b>5.1.2</b> Plots from the grid</a></li>
<li class="chapter" data-level="5.1.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#hdi-from-the-grid"><i class="fa fa-check"></i><b>5.1.3</b> HDI from the grid</a></li>
<li class="chapter" data-level="5.1.4" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#automating-the-grid"><i class="fa fa-check"></i><b>5.1.4</b> Automating the grid</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Inferring a Binomial Probability</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo (MCMC)</a></li>
<li class="chapter" data-level="8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html"><i class="fa fa-check"></i><b>8</b> JAGS – Just Another Gibbs Sampler</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#what-jags-is"><i class="fa fa-check"></i><b>8.1</b> What JAGS is</a></li>
<li class="chapter" data-level="8.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#a-complete-example-estimating-a-proportion"><i class="fa fa-check"></i><b>8.2</b> A Complete Example: estimating a proportion</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model"><i class="fa fa-check"></i><b>8.2.1</b> The Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#load-data"><i class="fa fa-check"></i><b>8.2.2</b> Load Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#specify-the-model"><i class="fa fa-check"></i><b>8.2.3</b> Specify the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#run-the-model"><i class="fa fa-check"></i><b>8.2.4</b> Run the model</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-coda"><i class="fa fa-check"></i><b>8.2.5</b> Using coda</a></li>
<li class="chapter" data-level="8.2.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-bayesplot"><i class="fa fa-check"></i><b>8.2.6</b> Using bayesplot</a></li>
<li class="chapter" data-level="8.2.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-kruschkes-functions"><i class="fa fa-check"></i><b>8.2.7</b> Using Kruschke’s functions</a></li>
<li class="chapter" data-level="8.2.8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#optional-arguments-to-jags"><i class="fa fa-check"></i><b>8.2.8</b> Optional arguments to jags()</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-2-comparing-two-proportions"><i class="fa fa-check"></i><b>8.3</b> Example 2: comparing two proportions</a><ul>
<li class="chapter" data-level="8.3.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-data"><i class="fa fa-check"></i><b>8.3.1</b> The data</a></li>
<li class="chapter" data-level="8.3.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-1"><i class="fa fa-check"></i><b>8.3.2</b> The model</a></li>
<li class="chapter" data-level="8.3.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#describing-the-model-to-jags"><i class="fa fa-check"></i><b>8.3.3</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="8.3.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#fitting-the-model"><i class="fa fa-check"></i><b>8.3.4</b> Fitting the model</a></li>
<li class="chapter" data-level="8.3.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#inspecting-the-results"><i class="fa fa-check"></i><b>8.3.5</b> Inspecting the results</a></li>
<li class="chapter" data-level="8.3.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#differnce-in-proportions"><i class="fa fa-check"></i><b>8.3.6</b> Differnce in proportions</a></li>
<li class="chapter" data-level="8.3.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#sampling-from-the-prior"><i class="fa fa-check"></i><b>8.3.7</b> Sampling from the prior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heierarchical-models.html"><a href="heierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Heierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#one-coin-from-one-mint"><i class="fa fa-check"></i><b>9.1</b> One coin from one mint</a></li>
<li class="chapter" data-level="9.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-one-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from one mint</a></li>
<li class="chapter" data-level="9.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-multiple-mints"><i class="fa fa-check"></i><b>9.3</b> Multiple coins from multiple mints</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Re)Doing Bayesain Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability" class="section level1">
<h1><span class="header-section-number">4</span> Probability</h1>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(
  <span class="dt">fig.width =</span> <span class="dv">6</span>,
  <span class="dt">fig.height =</span> <span class="fl">2.5</span>
)
<span class="kw">library</span>(ggformula)
<span class="kw">library</span>(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mosaic)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: mosaicData</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.
## 
## Note: If you use the Matrix package, be sure to load it BEFORE loading mosaic.</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median,
##     prop.test, quantile, sd, t.test, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</code></pre>

<div id="some-terminology" class="section level2">
<h2><span class="header-section-number">4.1</span> Some Terminology</h2>
<p>Probability is about quantifying the relative chances of various possible
outcomes of a random process.</p>
<p>As a very simple example (used to illustrate the terminology below), considering
rolling a single 6-sided die.</p>
<p><strong>sample space:</strong> The set of all possible outcomess of a random process.
[{1, 2, 3, 4, 5, 6}]</p>
<p><strong>event:</strong> a set of outcomes (subset of sample space) [E = {2, 4, 6} is the event that we obtain an even number]</p>
<p><strong>probability:</strong> a number between 0 and 1 assigned to an event
(really a function that assigns numbers to each event). We write this
P(E). [P(E) = 1/2 where E = {1, 2, 3}]</p>
<p><strong>random variable:</strong> a random process that produces a number. [So rolling a die can
be considered a random variable.]</p>
<p><strong>probability distribution:</strong> a description of all possible outcomes and their
probabilities.
For rolling a die we might do this with a table like this:</p>
<table>
<thead>
<tr class="header">
<th align="right">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="left">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1/6</td>
<td align="center">1/6</td>
<td align="center">1/6</td>
<td align="center">1/6</td>
<td align="center">1/6</td>
<td align="left">1/6</td>
</tr>
</tbody>
</table>
<p><strong>support (of a random variable):</strong> the set of possible values of
a random variable. This is very similar to the sample space.</p>
<p><strong>probabilty mass function (pmf):</strong> a fuction (often denoted with
<span class="math inline">\(p\)</span> or <span class="math inline">\(f\)</span>) that takes possible values of a
discrete random variable as input and returns the probability of that outcome.</p>
<ul>
<li><p>If <span class="math inline">\(S\)</span> is the support of the random variable, then
<span class="math display">\[
\sum_{x \in S} p(x) = 1
\]</span>
and any function with this property is a pmf.</p></li>
<li><p>Probabilites of events are
obtained by adding the probabilities of all outcomes in the event:</p></li>
</ul>
<p><span class="math display">\[
\operatorname{Prob}(E) = \sum_{x \in E} p(x)
\]</span>
* pmfs can be represented in a table (like the one above) or graphically with a
probability histogram or lollipop plot like the ones below. [These are not
for the 6-sided die, as we can tell because the probabilities are not
the same for each input; the die rolling exmaple would make very boring plots.]</p>
<p><img src="Redoing_files/figure-html/ch04-binom-01-1.png" width="576" /><img src="Redoing_files/figure-html/ch04-binom-01-2.png" width="576" /></p>
<ul>
<li>Histograms are generally presented on the <strong>density scale</strong> so the total
area of the histogram is 1. (In this example, the bin widths are 1, so this
is the same as being on the probability scale.)</li>
</ul>
<p><strong>probabilty density function (pdf):</strong> a function (often denoted with <span class="math inline">\(p\)</span> or <span class="math inline">\(f\)</span>)
that takes the possible
values of continuous random variable as input and returns the probability
<em>density</em>.</p>
<ul>
<li>If <span class="math inline">\(S\)</span> is the support of the random variable, then <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
<span class="math display">\[
\int_{x \in S} f(x) \; dx = 1
\]</span>
and any function with this property is a pmf.</li>
</ul>
<ul>
<li>Probabilities are obtained by integrating
(visualized by the area under the density curve):</li>
</ul>
<p><span class="math display">\[
\operatorname{Prob}(a \le X \le b) = \int_a^b f(x) \; dx
\]</span></p>
<p><img src="Redoing_files/figure-html/ch04-beta-01-1.png" width="576" /></p>
<p><strong>kernel function:</strong>
If <span class="math inline">\(\int_{x \in S} f(x) \; dx = k\)</span> for some real number <span class="math inline">\(k\)</span>, then
<span class="math inline">\(f\)</span> is a kernel function. We can obtain the pdf from the kernel by dividing
by <span class="math inline">\(k\)</span>.</p>
<p><strong>cumulative distribution function (cdf):</strong> a function (often denoted with a
capital <span class="math inline">\(F\)</span>) that takes a possible value
of a random variable as input and returns the probabilty of obtaining a
value less than or equal to the input:
<span class="math display">\[
F_X(x) = \operatorname{Prob}(X \le x)
\]</span>
cdfs can be defined for both discrete and continuous random variables.</p>
<p><strong>a family of distributions:</strong> is a collection of distributions which
share common features but are distinguished by different parameter values.
For example, we could have the family of distributions of fair dice
random variables. The parameter would tell us how many sides the die has.
Statisticians call this family the <strong>discrte uniform distributions</strong> because
all the probabilities are equal (1/6 for 6-sided die, 1/10 for a <span class="math inline">\(D_10\)</span>, etc.).</p>
<p>We will get to know several important families of distributions, among them
the <strong>binomial</strong>, <strong>beta</strong>, <strong>normal</strong>, and <strong>t</strong> families will be
especially useful. You may already be familiar with some or all of these.
We will also use distributions that have no name and are only described by
a pmf or pdf, or perhaps only by a large number of random samples from which
we attempt to estimate the pmf or pdf.</p>
</div>
<div id="distributions-in-r" class="section level2">
<h2><span class="header-section-number">4.2</span> Distributions in R</h2>
<p>pmfs, pdfs, and cdfs are available in R for many important families
of distributions. You just need to know a few things:</p>
<ul>
<li>each family has a standard abbreviation in R</li>
<li>pmf and pdf functions begin with the letter <code>d</code> followed by the family abbreviation</li>
<li>cdf functions begin with the letter <code>p</code> follwed by the family abbreviation</li>
<li>the inverse of the cdf function is called a quantile function,
it starts with the letter <code>q</code></li>
<li>functions beginning with <code>r</code> can generate random samples from a distribution</li>
<li>help for any of these functions will tell you what R calls the parameters
of the family.</li>
<li><code>gf_dist()</code> can be used to make various plots of distributions.</li>
</ul>
<div id="example-normal-distributions" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Example: Normal distributions</h3>
<p>As an exmple, let’s look the family of normal distributions. If you type
<code>dnorm(</code> and then hit TAB or if you type <code>args(dnorm)</code> you can see the arguments
for this function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(dnorm)</code></pre>
<pre><code>## function (x, mean = 0, sd = 1, log = FALSE) 
## NULL</code></pre>
<p>From this we see that the parameters are called <code>mean</code> and <code>sd</code> and have
default value of 0 and 1. These values will be used if we don’t specify
somethng else.
As with many of the pmf and pdf functions,
there is also an option to get back the log of the
pmf or pdf by setting <code>log = TRUE</code>. This turns out to be computationally much
more efficient in many contexts, as we will see.</p>
<p>Let’s begin with some pictures of a normal distribution with
mean 10 and standard deviation 1:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;norm&quot;</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>, <span class="dt">title =</span> <span class="st">&quot;pdf for Norm(10, 2)&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch04-norm-01-1.png" width="576" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;norm&quot;</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>, <span class="dt">kind =</span> <span class="st">&quot;cdf&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;cdf for Norm(10, 2)&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch04-norm-01-2.png" width="576" /></p>
<p>Now some exercises. Assume <span class="math inline">\(X \sim {\sf Norm}(10, 2)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>What is <span class="math inline">\(\operatorname{Prob}(X \le 5)\)</span>?</p>
<p>We can see by inspection that it is less that 0.5. <code>pnorm()</code> will give us
the value we are after; <code>xpnorm()</code> will provide more verbose output and a plot
as well.</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## [1] 0.006209665</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xpnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## </code></pre>
<pre><code>## If X ~ N(10, 2), then</code></pre>
<pre><code>##  P(X &lt;= 5) = P(Z &lt;= -2.5) = 0.00621</code></pre>
<pre><code>##  P(X &gt;  5) = P(Z &gt;  -2.5) = 0.9938</code></pre>
<pre><code>## </code></pre>
<p><img src="Redoing_files/figure-html/ch04-pnorm-01-1.png" width="576" /></p>
<pre><code>## [1] 0.006209665</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>What is <span class="math inline">\(\operatorname{Prob}(5 \le X \le 10)\)</span>?</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## [1] 0.4937903</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>How tall is the density function at it’s peak?</p>
<p>Normal distributions are symmetric about their means, so we need the
value of the pdf at 10.</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## [1] 0.1994711</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>What is the mean of a Norm(10, 2) distribution?</p>
<p>Ignoring for the moment that we know the answer is 10, we can compute it.
Notice the use of <code>dnorm()</code> in the computation.</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">integrate</span>(<span class="cf">function</span>(x) x <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>), <span class="op">-</span><span class="ot">Inf</span>, <span class="ot">Inf</span>)</code></pre>
<pre><code>## 10 with absolute error &lt; 0.0011</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>What is the variance of a Norm(10, 2) distribution?</p>
<p>Again, we know the answer is the square of the standard deviation, so 4.
But let’s get R to compute it in a way that would work for other distributions
as well.</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">integrate</span>(<span class="cf">function</span>(x) (x <span class="op">-</span><span class="st"> </span><span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>), <span class="op">-</span><span class="ot">Inf</span>, <span class="ot">Inf</span>)</code></pre>
<pre><code>## 4 with absolute error &lt; 7.1e-05</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Simulate a data set with 50 values drawn from a <span class="math inline">\({\sf Norm}(10, 2)\)</span>
distribution and make a histogram of the results and overlay the
normal pdf for comparison.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)
<span class="co"># be sure to use a density histogram so it is on the same scale as the pdf!</span>
<span class="kw">gf_dhistogram</span>(<span class="op">~</span><span class="st"> </span>x, <span class="dt">bins =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_dist</span>(<span class="st">&quot;norm&quot;</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch04-rnorm-1.png" width="576" /></p>
</div>
<div id="simulating" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Simulating</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggformula)
<span class="kw">library</span>(dplyr)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())
<span class="co"># Flip a coin N times and compute the running proportion of heads at each flip.</span>
<span class="co"># Generate a random sample of N flips (heads = 1, tails = 0):</span>
flipSequence &lt;-<span class="st"> </span>
<span class="st">  </span><span class="cf">function</span>(<span class="dt">size =</span> <span class="dv">500</span>, <span class="dt">p =</span> <span class="fl">0.5</span>) {
    <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p, p), <span class="dt">size =</span> size, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
  }

A &lt;-
<span class="st">  </span><span class="kw">data_frame</span>(
    <span class="dt">n =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>,
    <span class="dt">flip =</span> <span class="kw">flipSequence</span>(<span class="dv">500</span>),
    <span class="dt">running_count =</span> <span class="kw">cumsum</span>(flip),
    <span class="dt">running_prop  =</span> running_count <span class="op">/</span><span class="st"> </span>n
  )</code></pre>
<pre><code>## Warning: `data_frame()` is deprecated, use `tibble()`.
## This warning is displayed once per session.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_line</span>(
  running_prop <span class="op">~</span><span class="st"> </span>n, <span class="dt">data =</span> A, 
  <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), 
  <span class="dt">xlab =</span> <span class="st">&quot;Flip Number&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proportion Heads&quot;</span>, 
  <span class="dt">main =</span> <span class="st">&quot;Running Proportion of Heads&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch04-simulation-1.png" width="576" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># # Plot a dotted horizontal reference line:</span>
<span class="co"># abline( h = pHeads , lty = &quot;dotted&quot; )</span>
<span class="co"># # Display the beginning of the flip sequence:</span>
<span class="co"># flipLetters &lt;- paste( c(&quot;T&quot;,&quot;H&quot;)[flipSequence[1:10]+1] , collapse = &quot;&quot; )</span>
<span class="co"># displayString &lt;- paste0( &quot;Flip Sequence = &quot; , flipLetters , &quot;...&quot; )</span>
<span class="co"># text( N , .9 , displayString , adj = c(1,0.5) , cex = 1.3 )</span>
<span class="co"># # Display the relative frequency at the end of the sequence.</span>
<span class="co"># text( N , .8 , paste(&quot;End Proportion =&quot;,runProp[N]) , adj = c(1,0.5) , cex = 1.3 )</span></code></pre>
</div>
</div>
<div id="joint-distributions" class="section level2">
<h2><span class="header-section-number">4.3</span> Joint Distributions</h2>
<p>Sometimes (most of the time, actually) we are interested joint distributions.
A joint distribution is the distribution of multiple random variables
that result from the same random process. For example, we might roll a pair
of dice and obtain two numbers (one for each die). Or we might collect
a random sample of people and record the height for each of them. Or me might
randomly select one person, but record multiple facts (height and weight, for example). All of these situations are covered by joint distributions.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div id="example-hair-and-eye-color" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Example: Hair and Eye Color</h3>
<p>Kruschke illustrates joint distributions with an example of hair and eye color
recorded for a number of people. <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># NB: there is a different HairEyeColor data set in datasets!</span>
CalvinBayes<span class="op">::</span>HairEyeColor <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Hair) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">Blue =</span> <span class="kw">sum</span>(Count[Eye <span class="op">==</span><span class="st"> &quot;Blue&quot;</span>]),
    <span class="dt">Green =</span> <span class="kw">sum</span>(Count[Eye <span class="op">==</span><span class="st"> &quot;Green&quot;</span>]),
    <span class="dt">Hazel =</span> <span class="kw">sum</span>(Count[Eye <span class="op">==</span><span class="st"> &quot;Hazel&quot;</span>]),
    <span class="dt">Brown =</span> <span class="kw">sum</span>(Count[Eye <span class="op">==</span><span class="st"> &quot;Brown&quot;</span>]))</code></pre>
<pre><code>## # A tibble: 4 x 5
##   Hair   Blue Green Hazel Brown
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Black    20     5    15    68
## 2 Blond    94    16    10     7
## 3 Brown    84    29    54   119
## 4 Red      17    14    14    26</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">df_stats</span>(Count <span class="op">~</span><span class="st"> </span>Hair <span class="op">+</span><span class="st"> </span>Eye, <span class="dt">data =</span> CalvinBayes<span class="op">::</span>HairEyeColor, <span class="dt">total =</span> sum)</code></pre>
<pre><code>##     Hair   Eye total
## 1  Black  Blue    20
## 2  Blond  Blue    94
## 3  Brown  Blue    84
## 4    Red  Blue    17
## 5  Black Brown    68
## 6  Blond Brown     7
## 7  Brown Brown   119
## 8    Red Brown    26
## 9  Black Green     5
## 10 Blond Green    16
## 11 Brown Green    29
## 12   Red Green    14
## 13 Black Hazel    15
## 14 Blond Hazel    10
## 15 Brown Hazel    54
## 16   Red Hazel    14</code></pre>
</div>
<div id="conditional-probability" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Conditional probability</h3>
</div>
<div id="independence-of-attributes" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Independence of attributes</h3>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Kruschke likes to write his integrals in a different order: <span class="math inline">\(\int dx \; f(x)\)</span>
instead of <span class="math inline">\(\int f(x) \; dx\)</span>. Either order means the same thing.<a href="probability.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Kruschke calls these 2-way distributions, but there can be more than variables
involved.<a href="probability.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The datasets package has a version of this data with a third
variable: <code>sex</code>. It is also stored in a different format (as a 3d table rather
than as a data frame).<a href="probability.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="some-useful-bits-of-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayes-rule-and-the-grid-method.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
